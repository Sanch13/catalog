<!DOCTYPE html>
<html lang="en">
{% load static %}

<head>
    {% block title %}
        <title>Каталог продукции</title>
    {% endblock title %}

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet"/>
    <link href="{% static 'css/style.css' %}" rel="stylesheet"/>
    <link href="{% static 'css/social_networks.css' %}" rel="stylesheet"/>
    <style>
        /* Стили для попапа */
        #inactivity-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgb(248, 244, 244);
            padding: 40px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            z-index: 1000;
            text-align: center;
            display: none; /* Попап по умолчанию скрыт */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 600px; /* Увеличиваем ширину */
            height: 300px; /* Увеличиваем высоту */
        }

        /* Стили для кнопок */
        .popup-button {
            width: 150px;
            padding: 10px 20px;
            margin: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 22px;
        }

        .btn-success {
            background-color: #28a745;
            color: white;
        }

        .btn-danger {
            background-color: #dc3545;
            color: white;
        }

        /* Дополнительные стили */
        #popup-timer {
            font-weight: bold;
            color: #dc3545;
            font-size: 20px;
        }

        .buttons-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }
    </style>


    {% block css %}
    {% endblock css %}

</head>

<body>

<header class="header">
    <div class="container-fluid px-5">
        <div class="row align-items-center justify-content-between">
            <div class="col-2 d-flex">
                <a href="{% url 'home' %}" class="link-logo">
                    <img src="{% static 'img/logo.svg' %}" alt="logo">
                </a>
            </div>
            <div class="col-8 d-flex justify-content-center">
                <ul class="main-menu d-flex justify-content-center">
                    <li class="col-auto">
                        <a href="{% url 'catalog:catalog' %}" class="btn-menu-header"
                           id="menu-catalog">
                            <div class="header-text">Подбор упаковки</div>
                        </a>
                    </li>
                    <li class="col-auto">
                        <a href="{% url 'catalog:about_miran' %}" class="btn-menu-header"
                           id="menu-about">
                            <div class="header-text">О Миран</div>
                        </a>
                    </li>
                    <li class="col-auto">
                        <a href="{% url 'catalog:contact_me' %}" class="btn-menu-header"
                           id="menu-contact">
                            <div class="header-text">Свяжитесь со мной</div>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="col-2 d-flex justify-content-end">
                <div class="btn-menu-header header-text" id="backButton">
                    <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"
                         fill="currentColor" class="bi bi-arrow-left" viewBox="0 1 20 16">
                        <path fill-rule="evenodd"
                              d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"/>
                    </svg>
                    Назад
                </div>
            </div>
        </div>
    </div>
</header>

<script src="{% static 'js/jquery-3.7.1.min.js' %}"></script>
<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>


<main class="main">
    {% block content %}
    {% endblock %}
</main>

<button id="scrollToTopBtn" class="scroll-to-top">&#8679;</button>

<div id="inactivity-popup">
    <div style="font-size: 22px;"><b>Вы хотите остаться на сайте?</b></div>
    <div class="buttons-container">
        <button class="popup-button btn-success" id="stay-button">ДА</button>
        <button class="popup-button btn-danger" id="leave-button">НЕТ</button>
    </div>
    <div class="" style="font-size: 22px;">Перенаправление через <span id="popup-timer"></span>
        секунд
    </div>
</div>

<div class="floating-container">
    <div class="image-container">
        <img src="{% static 'img/instagram.svg' %}" class="thumbnail" alt="Instagram"
             onclick="togglePopup(this)" data-popup-id="popup-1">
        <img src="{% static 'img/telegram.svg' %}" class="thumbnail" alt="Telegram"
             onclick="togglePopup(this)" data-popup-id="popup-2">
        <img src="{% static 'img/youtube.svg' %}" class="thumbnail" alt="YouTube"
             onclick="togglePopup(this)" data-popup-id="popup-3">
        <!-- Добавьте больше картинок по необходимости -->
    </div>
    <div class="popup-qr" id="popup-1">
        <img src="{% static 'img/instagram.svg' %}" alt="Popup Image" id="popupImage-1">
    </div>
    <div class="popup-qr" id="popup-2">
        <img src="{% static 'img/telegram.svg' %}" alt="Popup Image" id="popupImage-2">
    </div>
    <div class="popup-qr" id="popup-3">
        <img src="{% static 'img/youtube.svg' %}" alt="Popup Image" id="popupImage-3">
    </div>
</div>

{#<script>#}
{#    function togglePopup(thumbnail) {#}
{#        const popupId = thumbnail.getAttribute('data-popup-id');#}
{#        const popup = document.getElementById(popupId);#}
{#        const popupImage = popup.querySelector('img');#}
{##}
{#        if (popup.style.display === "none") {#}
{#            popup.style.display = "block";#}
{#        } else {#}
{#            popup.style.display = "none";#}
{#        }#}
{##}
{#        // Если всплывающее окно уже отображается и нажатая картинка та же, что и в окне#}
{#        if (popup.style.display === "block" && popupImage.src === thumbnail.src) {#}
{#            popup.style.display = "none";#}
{#        } else {#}
{#            popupImage.src = thumbnail.src;#}
{##}
{#            // Позиционирование всплывающего окна#}
{#            const rect = thumbnail.getBoundingClientRect();#}
{#            popup.style.left = `${rect.left}px`;#}
{#            popup.style.top = `${rect.bottom + window.scrollY}px`;#}
{##}
{#            popup.style.display = "block";#}
{#        }#}
{#    }#}
{##}
{#    window.onclick = function (event) {#}
{#        const popups = document.querySelectorAll('.popup');#}
{#        popups.forEach(popup => {#}
{#            if (event.target !== popup && !popup.contains(event.target)) {#}
{#                popup.style.display = "none";#}
{#            }#}
{#        });#}
{#    }#}
{##}
{#</script>#}
<script>
    // Показать кнопку при прокрутке вниз
    window.onscroll = function () {
        const scrollBtn = document.getElementById("scrollToTopBtn");
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            scrollBtn.style.display = "block";
        } else {
            scrollBtn.style.display = "none";
        }
    };

    // Плавная прокрутка страницы вверх при нажатии на кнопку
    document.getElementById("scrollToTopBtn").onclick = function () {
        window.scrollTo({top: 0, behavior: 'smooth'});
    };
</script>
<script>
    document.getElementById('backButton').addEventListener('click', function () {
        history.back();
    });
</script>
<script>
    const INACTIVITY_TIMEOUT = 6000000;
    const POPUP_TIMEOUT = 10000;

    let inactivityTimer;
    let countdownInterval;

    function resetInactivityTimer() {
        clearTimeout(inactivityTimer);
        inactivityTimer = setTimeout(showPopup, INACTIVITY_TIMEOUT);
    }

    function stopInactivityTimer() {
        clearTimeout(inactivityTimer);
    }

    function showPopup() {
        const popup = document.getElementById('inactivity-popup');
        popup.style.display = 'block'; // Показываем попап

        let secondsRemaining = POPUP_TIMEOUT / 1000;
        document.getElementById('popup-timer').textContent = secondsRemaining;

        if (countdownInterval) {
            clearInterval(countdownInterval);
        }

        countdownInterval = setInterval(() => {
            secondsRemaining--;
            document.getElementById('popup-timer').textContent = secondsRemaining;

            if (secondsRemaining <= 0) {
                clearInterval(countdownInterval);
                window.location.href = '/'; // Перенаправление по истечении времени
            }
        }, 1000);
    }

    // Обработчики кнопок
    document.getElementById('stay-button').addEventListener('click', () => {
        clearInterval(countdownInterval);
        resetInactivityTimer();
        document.getElementById('inactivity-popup').style.display = 'none';
    });

    document.getElementById('leave-button').addEventListener('click', () => {
        clearInterval(countdownInterval);
        window.location.href = '/';  // Немедленное перенаправление при нажатии "НЕТ"
    });

    document.addEventListener('DOMContentLoaded', (event) => {
        // Сброс таймера при загрузке страницы
        resetInactivityTimer();

        // События, которые будут сбрасывать таймер
        document.addEventListener('mousemove', resetInactivityTimer);
        document.addEventListener('keypress', resetInactivityTimer);
        document.addEventListener('scroll', resetInactivityTimer);
        document.addEventListener('click', resetInactivityTimer);

        // Получение всех видео на странице
        const videos = document.querySelectorAll('video');

        videos.forEach(video => {
            // Приостановка таймера при начале воспроизведения видео
            video.addEventListener('play', stopInactivityTimer);
            // Возобновление таймера при паузе или завершении воспроизведения видео
            video.addEventListener('pause', resetInactivityTimer);
            video.addEventListener('ended', resetInactivityTimer);
        });
    });
</script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const currentUrl = window.location.pathname;

        const menuCatalog = document.getElementById('menu-catalog');
        const menuAbout = document.getElementById('menu-about');
        const menuContact = document.getElementById('menu-contact');

        // Проверяем, какой URL и назначаем соответствующий класс active
        if (currentUrl.endsWith('/catalog/about/')) {
            menuAbout.classList.add('active');
        } else if (currentUrl.endsWith('/catalog/contact/')) {
            menuContact.classList.add('active');
        } else {
            menuCatalog.classList.add('active');
        }
    });


</script>

</body>
</html>
